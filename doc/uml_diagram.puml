@startuml

skinparam linetype ortho

package "View" {

    package "Activities" <<Rectangle>> {

        class AuthenticationActivity

        class SignInActivity

        class HomeActivity

        class ProfileActivity {
            profile : Profile
        }

        AuthenticationActivity "1" -- "1" HomeActivity : "Transitions to\nHomeActivity\nif logged in."
        AuthenticationActivity "1" -- "1" SignInActivity : "Transitions to\nSignInActivity\nif not logged in."
        SignInActivity "1" -- "1" HomeActivity : "Transitions to\nHomeActivity\nonce logged in."
        HomeActivity -- ProfileActivity
    }

    package "Fragments" <<Rectangle>> {

        class MoodListFragment {
            dataList : List<MoodEvent> 
            dataAdapter : ArrayAdapter<MoodEvent> 
            listView : ListView

            applyFilter(filter : String)
        }

        class SearchFragment {
            profileList : ProfileListFragment
            currentSearch : String
        }

        class AddFragment {
        }

        class FollowingFragment {
            profileList : ProfileListFragment
        }

        class DetailsFragment {
            mood : MoodEvent
            editingEnabled : boolean
        }

        class ProfileListFragment {
            listView : ListView
            dataList : List<Profile>

            applyFilter(filter : String)
        }

        HomeActivity "1" *-- "1" MapFragment
        HomeActivity "1" o-- "1" MoodListFragment
        HomeActivity "1" *-- "1" SearchFragment
        HomeActivity "1" *-- "1" AddFragment
        HomeActivity "1" *-- "1" FollowingFragment
        HomeActivity "1" o-- "1" FilterFragment
        HomeActivity "1" o-- "1" DetailsFragment
        ProfileActivity "1" o-- "1" MoodListFragment
        ProfileActivity "1" o-- "1" FilterFragment

        SearchFragment "1" o-- "2" ProfileListFragment
        FollowingFragment "1" o-- "1" ProfileListFragment

    }

}

package "Android API" <<Rectangle>> {

    interface Filterable
    interface Filter
    abstract class ArrayAdapter
}

package "Control" <<Rectangle>> {

    class MoodAdapter {
        dataList : List<MoodEvent>
        getFilter() : MoodFilter
    }

    class ProfileAdapter {
        dataList : List<MoodEvent>
        getFilter() : ProfileFilter
    }

    class MoodFilter {
        filter(constraint : CharSequence) <<override>>
    }

    class ProfileFilter {
        filter(constraint : CharSequence) <<override>>
    }
    
    Filterable "1" <|-- "1" MoodAdapter
    ArrayAdapter "1" <|-- "1" MoodAdapter : MoodEvent

    Filterable "1" <|-- "1" ProfileAdapter
    ArrayAdapter "1" <|-- "1" ProfileAdapter : Profile
    
    Filter "1" <|-- "1" MoodFilter
    Filter "1" <|-- "1" ProfileFilter

    ProfileAdapter -- ProfileFilter
    MoodAdapter "1" -- "1" MoodFilter 
}

MapFragment "1" -- "1" MoodAdapter
MoodListFragment "1" -- "1" MoodAdapter
MoodListFragment "1" -- "1" MoodFilter

ProfileListFragment "1" o-- "1" ProfileAdapter
ProfileListFragment "1" -- "1" ProfileFilter

MapFragment "1" -- "1" MoodFilter

package "Model" <<Rectangle>> {

    class UserProfile {
        UserProfile(username : String)
        UserProfile(username : String, firstName : String, lastName : String)
    }

    class MoodEvent {
        location : Location 
        dateTime : DateTime 
        remark : String 
        image : Image 
        situation : SocialSituation 
        emotion : Emotion
        MoodEvent(dateTime:DateTime,emotion:Emotion)
    }

    class Emotion {
        -emotions : static Map<String, Emotion>
        +get(name : String) : static Emotion

        -imageResource : String 
        -name : String 
    }

    class SocialSituation {
        -situations : static Map<String, SocialSituation>
        +get(key : String) : static SocialSituation

        -name : String
        -SocialSituation(name : String)
    }

    class Location {
        -latitude : double
        -longitude : double

        +Location(latitude:double,longitude:double)

        +getLatitude() : double
        +getLongitude() : double
    }

    class Profile {
        -username : final String
        -firstName : String
        -lastName : String

        +Profile(username : String)
        +Profile(username : String, firstName : String, lastName : String)
    }

    class PublicProfile {
        -following : boolean

        +PublicProfile(username : String)
        +PublicProfile(username : String, firstName : String, lastName : String)
    }

    package "Java API" <<Rectangle>> {
    class DateTime
    }   

    MoodEvent "1" o-- "1" Emotion
    MoodEvent "1" *-- "1" Location
    MoodEvent "1" o-- "1" SocialSituation
    MoodEvent "1" *-- "1" DateTime

    Profile "1" <|-- "1" UserProfile
    Profile "1" <|-- "1" PublicProfile

}

MoodAdapter "1" -- "0..*" MoodEvent
ProfileAdapter "1" -- "0..*" Profile

MoodFilter "1" -- "1" MoodEvent
ProfileFilter "1" -- "0..*" Profile

DetailsFragment "1" -- "1" MoodEvent

@enduml
